---
description: >-
  이 문서의 허가되지 않은 무단 복제나 배포 및 출판을 금지합니다. 본 문서의 내용 및 도표 등을 인용하고자 하는 경우 출처를 명시하고
  김종민(kimjmin@gmail.com)에게 사용 내용을 알려주시기 바랍니다.
---

# 5.6 범위 \(range\) 쿼리

  지금까지는 문자열 필드들의 검색에 대해 살펴보았습니다. Elasticsearch는 이 외에도 **숫자**나 **날짜** 형식들의 저장이 가능합니다. 숫자, 날짜 형식은 **range** 쿼리를 이용해서 검색을 합니다.

  **range** 쿼리의 예제를 위해 먼저 아래의 **phones** 인덱스를 추가하겠습니다.

{% code-tabs %}
{% code-tabs-item title="bulk 명령으로 phone 인덱스 추가" %}
```javascript
POST phones/_bulk
{"index":{"_id":1}}
{"model":"Samsung GalaxyS 5","price":475,"date":"2014-02-24"}
{"index":{"_id":2}}
{"model":"Samsung GalaxyS 6","price":795,"date":"2015-03-15"}
{"index":{"_id":3}}
{"model":"Samsung GalaxyS 7","price":859,"date":"2016-02-21"}
{"index":{"_id":4}}
{"model":"Samsung GalaxyS 8","price":959,"date":"2017-03-29"}
{"index":{"_id":5}}
{"model":"Samsung GalaxyS 9","price":1059,"date":"2018-02-25"}
```
{% endcode-tabs-item %}
{% endcode-tabs %}

\( 🤓 위 예제 데이터는 실제 상품 정보와 아무런 관련이 없습니다 \)

range 쿼리는 `range : { <필드명>: { <파라메터>:<값> } }` 으로 입력됩니다. range 쿼리 파라메터는 아래의 4가지가 있습니다. 

* **gte** \(Greater-than or equal to\) - 이상 \(같거나 큼\)
* **gt** \(Greater-than\) – 초과 \(큼\)
* **lte** \(Less-than or equal to\) - 이하 \(같거나 작음\)
* **lt** \(Less-than\) - 미만 \(작음\)

  다음은 phone 인덱스에서 **price** 필드 값이 **700 이상**, **900 미만**인 데이터를 검색하는 쿼리입니다.

{% tabs %}
{% tab title="request" %}
{% code-tabs %}
{% code-tabs-item title="price 값이 700 이상 900 미만인 데이터 검색" %}
```javascript
GET phones/_search
{
  "query": {
    "range": {
      "price": {
        "gte": 700,
        "lt": 900
      }
    }
  }
}
```
{% endcode-tabs-item %}
{% endcode-tabs %}
{% endtab %}

{% tab title="response" %}
{% code-tabs %}
{% code-tabs-item title="price 값이 700 이상 900 미만인 데이터 검색 결과" %}
```javascript
{
  "took" : 1,
  "timed_out" : false,
  "_shards" : {
    "total" : 1,
    "successful" : 1,
    "skipped" : 0,
    "failed" : 0
  },
  "hits" : {
    "total" : {
      "value" : 2,
      "relation" : "eq"
    },
    "max_score" : 1.0,
    "hits" : [
      {
        "_index" : "phones",
        "_type" : "_doc",
        "_id" : "2",
        "_score" : 1.0,
        "_source" : {
          "model" : "Samsung GalaxyS 6",
          "price" : 795,
          "date" : "2015-03-15"
        }
      },
      {
        "_index" : "phones",
        "_type" : "_doc",
        "_id" : "3",
        "_score" : 1.0,
        "_source" : {
          "model" : "Samsung GalaxyS 7",
          "price" : 859,
          "date" : "2016-02-21"
        }
      }
    ]
  }
}

```
{% endcode-tabs-item %}
{% endcode-tabs %}
{% endtab %}
{% endtabs %}

  price 값이 700과 900 사이의 795, 859인 두개의 결과가 리턴 되었습니다.

### 날짜 검색

  날짜도 숫자와 마찬가지로 **range** 쿼리의 사용이 가능합니다. 기본적으로 Elasticsearch 에서 날짜 값은 2016-01-01 또는 2016-01-01T10:15:30 과 같이 JSON 에서 일반적으로 사용되는 **ISO8601** 형식을 사용합니다. 다음은 date 필드의 날짜가 2016년 1월 1일 이후인 도큐먼트들을 검색하는 쿼리입니다.

